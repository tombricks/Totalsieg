scripted_gui = {

	MOON_WAR_scripted_gui = {
		context_type = player_context
		window_name = "MOON_WAR_Window"

		visible = {
			always = yes
		}

		properties = {
			MOON_WAR_Tile = {
				frame = v
				x = x_offset
				image = "[This.MOON_WAR_Highlight]"
			}

			id_text = {
				x = id_x_offset
			}

			MOON_WAR_Owner = {
				x = id_owner_offset
				image = "[This.MOON_WAR_Owner_Icon]"
			}

			MOON_WAR_Status = {
				x = id_owner_offset
				frame = status_frame
			}

			MOON_WAR_Debug_Button = {
				image = "[This.MOON_WAR_Debug_Button]"
			}

			MOON_WAR_TILE_INFO_Governor_GFX = {
				image = "[This.MOON_WAR_Tile_Governor_GFX]"
			}
		}

		dynamic_lists = {
			MOON_WAR_Map_Grid = {
				array = Global.MOON_WAR_TERRAIN_MAP
				entry_container = "MOON_WAR_Tile_Entry"
				value = v
				index = i
			}
		}

		effects = {
			MOON_WAR_Tile_click = {
				if = {
					limit = {
						NOT = {
							check_variable = { MOON_WAR_Selected = i }
						}
					}
					set_variable = { MOON_WAR_Selected = i }

					else = {
						set_variable = { MOON_WAR_Selected = -1 }
					}
				}
			}

			MOON_WAR_Debug_Button_click = {
				if = {
					limit = {
						has_country_flag = MOON_WAR_DEBUG
					}
					clr_country_flag = MOON_WAR_DEBUG
					else = {
						set_country_flag = MOON_WAR_DEBUG
					}
				}
			}

			MOON_WAR_Debug_GER_click = { set_variable = { Global.MOON_WAR_CONTROLLER_MAP^MOON_WAR_Selected = GER } }
			MOON_WAR_Debug_JAP_click = { set_variable = { Global.MOON_WAR_CONTROLLER_MAP^MOON_WAR_Selected = JAP } }
			MOON_WAR_TILE_INFO_Add_Development_click = { add_to_variable = { Global.MOON_WAR_STATUS_MAP^MOON_War_Selected = 1  } }
		}

		triggers = {
			id_text_visible = {
			}
			
			MOON_WAR_Tile_visible = {
				if = {
					limit = {
						set_temp_variable = { TARGET_OFFSET = i }
						MOON_WAR_Offset_Trigger = yes
					}
					set_temp_variable = { x_offset = 48 }
					
					else = {
						set_temp_variable = { x_offset = 0 }
					}
				}
			}
			
			id_text_visible = {
				if = {
					limit = { 
						set_temp_variable = { TARGET_OFFSET = i }
						MOON_WAR_Offset_Trigger = yes
					}
					set_temp_variable = { id_x_offset = 64 }
					
					else = {
						set_temp_variable = { id_x_offset = 32 }
					}
				}
				has_country_flag = MOON_WAR_DEBUG
			}
			
			MOON_WAR_Owner_visible = {
				if = {
					limit = { 
						set_temp_variable = { TARGET_OFFSET = i }
						MOON_WAR_Offset_Trigger = yes
					}
					set_temp_variable = { id_owner_offset = 80 }
					
					else = {
						set_temp_variable = { id_owner_offset = 32 }
					}
				}
			}

			MOON_WAR_Tile_Information_visible = {
				NOT = {
					check_variable = { MOON_WAR_Selected = -1 }
				}
			}

			MOON_WAR_Status_visible = {
				if = {
					limit = {
						check_variable = { Global.MOON_WAR_STATUS_MAP^i > 4 }
					}
					set_temp_variable = { status_frame = 9 }

					else_if = {
						limit = {
							check_variable = { Global.MOON_WAR_STATUS_MAP^i > 0 }
						}
						set_temp_variable = { status_frame = 14 }
					}
				}
				if = {
					limit = {
						set_temp_variable = { lunar_owner = Global.MOON_WAR_CONTROLLER_MAP^i }
						var:lunar_owner = {
							check_variable = { Lunar_Capital = i }
						}
					}
					set_temp_variable = { status_frame = 4 }
				}
				check_variable = { Global.MOON_WAR_STATUS_MAP^i > 0 }
			}

			MOON_WAR_Debug_Button_visible = { is_debug = yes }
			MOON_WAR_Debug_GER_visible = { has_country_flag = MOON_WAR_DEBUG }
			MOON_WAR_Debug_JAP_visible = { has_country_flag = MOON_WAR_DEBUG }
			MOON_WAR_TILE_INFO_Add_Development_visible = { has_country_flag = MOON_WAR_DEBUG }
		}
	}
	
}

